# ========================================
# TMUX Configuration - Browser-Friendly
# ========================================
# Optimized to avoid conflicts with browser shortcuts
# Prefix: Ctrl+Space (less conflict than Ctrl+b or Ctrl+a)

# === Core Settings ===
# Change prefix from Ctrl+b to Ctrl+Space
unbind C-b
set-option -g prefix C-Space
bind-key C-Space send-prefix

# Enable mouse support (scrolling, pane selection, resizing)
set -g mouse on

# Increase scrollback buffer size
set -g history-limit 50000

# Set default terminal to support 256 colors
set -g default-terminal "tmux-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# Start windows and panes at 1, not 0
set -g base-index 1
setw -g pane-base-index 1

# Renumber windows automatically when one is closed
set -g renumber-windows on

# Allow automatic renaming of windows
setw -g automatic-rename on

# Set terminal title
set -g set-titles on
set -g set-titles-string '#S:#W - tmux'

# === Key Bindings (Browser-Safe) ===
# Reload configuration
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Split panes using | and - (more intuitive)
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# Split panes with Alt (Letter keys - NO SYMBOLS)
bind -n M-v split-window -h -c "#{pane_current_path}"   # Alt+v : Split Vertical (Side-by-side)
bind -n M-h split-window -v -c "#{pane_current_path}"   # Alt+h : Split Horizontal (Top/Bottom)

# Navigate panes with Alt+Arrow (no Ctrl conflicts)
bind -n M-Left select-pane -L
bind -n M-Right select-pane -R
bind -n M-Up select-pane -U
bind -n M-Down select-pane -D

# Resize panes with Prefix + Arrow keys
bind -r Left resize-pane -L 5
bind -r Right resize-pane -R 5
bind -r Up resize-pane -U 5
bind -r Down resize-pane -D 5

# Create new window with Prefix+n (not Ctrl+n which conflicts)
bind n new-window -c "#{pane_current_path}"

# Switch windows with Prefix+number (browser uses Ctrl+number)
# Already default, but making it explicit

# Close pane/window with Prefix+x (not Ctrl+w which conflicts with browser)
bind x kill-pane

# === Copy Mode (Vi-style) ===
# Use vi-style keys in copy mode
setw -g mode-keys vi

# Enter copy mode with Prefix+[
bind [ copy-mode

# Copy selection with 'y' (like vi)
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel

# Paste with Prefix+]
bind ] paste-buffer

# === Status Bar ===
# Update status bar every 1 second
set -g status-interval 1

# Status bar position
set -g status-position bottom

# Status bar styling
set -g status-style 'bg=#1e1e2e fg=#cdd6f4'

# Left side: session name
set -g status-left '#[bg=#89b4fa,fg=#1e1e2e,bold] #S #[default] '
set -g status-left-length 20

# Right side: date and time
set -g status-right '#[fg=#cdd6f4] %Y-%m-%d #[fg=#89b4fa,bold]%H:%M:%S '
set -g status-right-length 50

# Window status format
setw -g window-status-format ' #I:#W '
setw -g window-status-current-format '#[bg=#89b4fa,fg=#1e1e2e,bold] #I:#W #[default]'

# === Pane Borders ===
set -g pane-border-style 'fg=#45475a'
set -g pane-active-border-style 'fg=#89b4fa'

# === Activity Monitoring ===
# Highlight window with activity
setw -g monitor-activity on
set -g visual-activity off

# === Misc Settings ===
# Don't delay Escape key (important for vim)
set -sg escape-time 0

# Allow programs to use clipboard
set -g set-clipboard on

# Enable focus events
set -g focus-events on

# ========================================
# Quick Reference
# ========================================
# Prefix: Ctrl+Space
#
# Sessions:
#   Prefix + d          Detach from session
#   Prefix + s          List sessions
#   Prefix + $          Rename session
#
# Windows:
#   Prefix + n          New window
#   Prefix + ,          Rename window
#   Prefix + &          Kill window
#   Prefix + 0-9        Switch to window 0-9
#   Prefix + p          Previous window
#   Prefix + n          Next window
#
# Panes:
#   Alt + v             Split Vertical (Side-by-side)
#   Alt + h             Split Horizontal (Top/Bottom)
#   Prefix + |          Split vertical (alternative)
#   Prefix + -          Split horizontal (alternative)
#   Prefix + x          Kill pane
#   Alt + Arrows        Navigate panes
#   Prefix + Arrows     Resize panes
#   Prefix + z          Toggle pane zoom
#   Prefix + o          Next pane
#
# Copy Mode:
#   Prefix + [          Enter copy mode
#   v                   Begin selection (in copy mode)
#   y                   Copy selection (in copy mode)
#   Prefix + ]          Paste
#
# Other:
#   Prefix + r          Reload config
#   Prefix + ?          List keybindings
